jQuery(function(e){var t,a=e("#food_image_gallery"),i=e("#food_images_container").find("ul.food_images");e(".add_food_images").on("click","a",function(o){var l=e(this);o.preventDefault(),t?t.open():((t=wp.media.frames.food_gallery=wp.media({title:l.data("choose"),button:{text:l.data("update")},states:[new wp.media.controller.Library({title:l.data("choose"),filterable:"all",multiple:!0})]})).on("select",function(){var e=t.state().get("selection"),o=a.val();e.map(function(e){if((e=e.toJSON()).id){o=o?o+","+e.id:e.id;var t=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url;i.append('<li class="image" data-attachment_id="'+e.id+'"><img src="'+t+'" /><ul class="actions"><li><a href="#" class="delete" title="'+l.data("delete")+'">'+l.data("text")+"</a></li></ul></li>")}}),a.val(o)}),t.open())}),i.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"rp-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(){var t="";e("#food_images_container").find("ul li.image").css("cursor","default").each(function(){var a=e(this).attr("data-attachment_id");t=t+a+","}),a.val(t)}}),e("#food_images_container").on("click","a.delete",function(){e(this).closest("li.image").remove();var t="";return e("#food_images_container").find("ul li.image").css("cursor","default").each(function(){var a=e(this).attr("data-attachment_id");t=t+a+","}),a.val(t),e("#tiptip_holder").removeAttr("style"),e("#tiptip_arrow").removeAttr("style"),!1})});